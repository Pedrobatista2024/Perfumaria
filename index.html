<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Catálogo de Perfumes - S&P Perfum</title>
    <link rel="stylesheet" href="style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400..900;1,400..900&family=Roboto:wght@400;700&display=swap" rel="stylesheet">
</head>
<body>

    <header>
        <img src="./assets/images/capa.png" alt="Capa da Loja S&P Perfum" class="header-img">
        <div class="header-content">
            <h1>S&P Perfum</h1>
            <p>A arte de perfumar o mundo com elegância e sofisticação.</p>
        </div>
    </header>

    <main>
        <section class="catalogo" id="catalogo-container">
            </section>
    </main>

    <footer>
        <p>&copy; 2024 S&P Perfum. Todos os direitos reservados.</p>
    </footer>

    <script>
        const catalogoContainer = document.getElementById('catalogo-container');

        fetch('_data/produtos.yml')
          .then(response => {
            if (!response.ok) {
              console.error('Erro ao carregar o arquivo de produtos:', response.status);
              catalogoContainer.innerHTML = '<p style="text-align: center; color: #ff0000;">Erro ao carregar os produtos. Verifique se a pasta "_data" e o arquivo "produtos.yml" foram criados.</p>';
              return Promise.reject('Erro ao carregar o arquivo de produtos.');
            }
            return response.text();
          })
          .then(yamlText => {
            const produtos = jsyaml.load(yamlText);

            if (produtos && Array.isArray(produtos)) {
              produtos.forEach(produto => {
                  const card = document.createElement('div');
                  card.classList.add('perfume-card');

                  card.innerHTML = `
                      <img src="${produto.imagem}" alt="${produto.nome}">
                      <div class="perfume-info">
                          <h2>${produto.nome}</h2>
                          <p class="genero">${produto.genero}</p>
                          <p class="fragrancia">Fragrância: ${produto.fragrancia}</p>
                          <p class="descricao">${produto.descricao}</p>
                          <p class="preco">${produto.preco}</p>
                          <a href="${produto.url_wpp}" class="btn-comprar">Comprar</a>
                      </div>
                  `;
                  catalogoContainer.appendChild(card);
              });
            } else {
              console.error('Formato de dados inválido no arquivo produtos.yml');
              catalogoContainer.innerHTML = '<p style="text-align: center; color: #ff0000;">Os dados dos produtos estão em um formato inválido.</p>';
            }
          })
          .catch(error => {
            console.error('Ocorreu um erro:', error);
            if (catalogoContainer.innerHTML === '') {
              catalogoContainer.innerHTML = '<p style="text-align: center; color: #ff0000;">Nenhum produto cadastrado ainda. Adicione seus produtos no painel de administração!</p>';
            }
          });
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/js-yaml/4.1.0/js-yaml.min.js"></script>
</body>
</html>